<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Forgot Password - S.R Public School</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
  </head>
  <body>
    <div class="login-wrapper">
      <div class="login-container">
        <div class="login-content">
          <div class="login-header">
            <div class="logo">
              <img src="image/logo.png" alt="School Logo" />
              <h1>S.R Public School</h1>
            </div>
            <p>Reset Your Password</p>
          </div>

          <!-- User Details Section -->
          <form id="userDetailsForm" class="login-form" >  
            <div class="form-group">
              <div id="enrollmentError" class="error-message"></div>
              <label for="enrollment">
                <i class="fas fa-id-card"></i>
                Enrollment Number
              </label>
              <input
                type="text"
                id="enrollment"
                name="enrollment"
                required
                placeholder="Enter your enrollment number"
                pattern="[A-Za-z0-9]+"
                title="Please enter a valid enrollment number"
              />
            </div>
            <div class="form-group">
              <label for="fullName">
                <i class="fas fa-user"></i>
                Full Name
              </label>
              <input
                type="text"
                id="fullName"
                name="fullName"
                required
                placeholder="Enter your full name"
                pattern="[A-Za-z\s]+"
                title="Please enter a valid name"
              />
              <div id="nameError" class="error-message"></div>
            </div>
            <button type="submit" class="login-btn">
              <i class="fas fa-paper-plane"></i>
              Send OTP
            </button>
          </form>

          <!-- OTP Verification Section (Hidden initially) -->
          <form id="otpForm" class="login-form" style="display: none">
            <div>
              <label>
                <i class="fas fa-key"></i>
                Enter OTP
              </label>
              <div class="otp-inputs">
                <input
                  type="text"
                  maxlength="1"
                  pattern="[0-9]"
                  inputmode="numeric"
                  class="otp-input"
                />
                <input
                  type="text"
                  maxlength="1"
                  pattern="[0-9]"
                  inputmode="numeric"
                  class="otp-input"
                />
                <input
                  type="text"
                  maxlength="1"
                  pattern="[0-9]"
                  inputmode="numeric"
                  class="otp-input"
                />
                <input
                  type="text"
                  maxlength="1"
                  pattern="[0-9]"
                  inputmode="numeric"
                  class="otp-input"
                />
                <input
                  type="text"
                  maxlength="1"
                  pattern="[0-9]"
                  inputmode="numeric"
                  class="otp-input"
                />
                <input
                  type="text"
                  maxlength="1"
                  pattern="[0-9]"
                  inputmode="numeric"
                  class="otp-input"
                />
              </div>
              <div id="otpError" class="error-message"></div>
            </div>
            <div class="resend-otp">
              <span id="timer">Resend OTP in: 30s</span>
              <button type="button" id="resendBtn" class="resend-btn" disabled>
                Resend OTP
              </button>
            </div>
            <button type="submit" class="login-btn">
              <i class="fas fa-check"></i>
              Verify OTP
            </button>
          </form>

          <!-- New Password Section (Hidden initially) -->
          <form id="newPasswordForm" class="login-form" style="display: none" method="post" action="/forget/newPass">
            <div class="form-group">
              <label for="newPassword">
                <i class="fas fa-lock"></i>
                New Password
              </label>
              <div class="password-input">
                <input type="hidden" id="userId" name="id" value="">
                <input
                  type="password"
                  id="newPassword"
                  name="newPassword"
                  required
                  placeholder="Enter new password"
                  pattern="^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{8,}$"
                  title="Password must be at least 8 characters long and include both letters and numbers"
                />
                <button type="button" class="toggle-password">
                  <i class="fas fa-eye"></i>
                </button>
              </div>
              <div id="passwordError" class="error-message"></div>
            </div>
            <div class="form-group">
              <label for="confirmPassword">
                <i class="fas fa-lock"></i>
                Confirm Password
              </label>
              <div class="password-input">
                <input
                  type="password"
                  id="confirmPassword"
                  name="confirmPassword"
                  required
                  placeholder="Confirm new password"
                />
                <button type="button" class="toggle-password">
                  <i class="fas fa-eye"></i>
                </button>
              </div>
            </div>
            <button type="submit" class="login-btn">
              <i class="fas fa-save"></i>
              Reset Password
            </button>
          </form>

          <div class="login-footer">
            <a href="/login">Back to Login</a>
          </div>
        </div>
      </div>
    </div>

    <script> 
       const UserData = <%- JSON.stringify(user) %>;
    </script>
    <script src="/js/forget.js"></script>
  </body>
</html>
